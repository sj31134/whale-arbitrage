# 전략 추천 기능 개선

> **작성일**: 2025-11-23  
> **문제**: 진입 조건을 만족하지 않는 날짜에 대한 피드백 부족

---

## 🔍 문제 분석

### 발생 상황
- 사용자가 특정 날짜(예: 2025-11-22)를 선택
- 해당 날짜에 Z-Score > 2.5를 만족하는 거래소 쌍이 없음
- 에러 메시지만 표시되고 대안이 제시되지 않음

### 원인
- 진입 조건(Z-Score > 2.5)이 엄격함
- 시장 상황에 따라 모든 날짜에서 조건을 만족하지 않을 수 있음
- 사용자에게 대안이나 제안이 없음

---

## ✅ 해결 방법

### 1. 제안 기능 추가
진입 조건을 만족하지 않을 때:
- 가장 높은 Z-Score를 가진 거래소 쌍 제안
- 모든 거래소 쌍의 정보 표시
- 진입 조건 만족 여부 표시

### 2. UI 개선
- 제안된 전략을 expander로 표시
- 모든 거래소 쌍 정보를 테이블로 표시
- 진입 조건 미만족 시 경고 메시지

---

## 📊 개선된 응답 형식

### Before
```json
{
    "success": false,
    "error": "2025-11-22에 진입 조건을 만족하는 거래소 쌍이 없습니다. (Z-Score > 2.5 필요)"
}
```

### After
```json
{
    "success": false,
    "error": "2025-11-22에 진입 조건을 만족하는 거래소 쌍이 없습니다. (Z-Score > 2.5 필요)",
    "suggestion": {
        "pair": "바이낸스-비트겟",
        "pair_code": "binance_bitget",
        "z_score": 1.85,
        "premium": 0.012,
        "direction": "short_premium",
        "message": "가장 높은 Z-Score: 바이낸스-비트겟 (Z-Score=1.85, 프리미엄=1.20%)"
    },
    "all_pairs": [
        {
            "pair": "바이낸스-비트겟",
            "z_score": 1.85,
            "premium": 0.012,
            "direction": "short_premium"
        },
        ...
    ]
}
```

---

## 🎨 UI 개선

### 제안된 전략 표시
- Expander로 접을 수 있는 형태
- 거래소 쌍, Z-Score, 프리미엄, 방향 표시
- 진입 조건 미만족 경고

### 모든 거래소 쌍 정보
- 테이블 형태로 표시
- Z-Score 절댓값 기준 정렬
- 진입 조건 만족 여부 표시

---

## 📝 수정된 파일

1. **app/utils/recommender.py**
   - 제안 기능 추가
   - 모든 거래소 쌍 정보 반환

2. **app/pages/strategy_recommender_page.py**
   - 제안된 전략 UI 추가
   - 모든 거래소 쌍 정보 테이블 추가

---

## ✅ 개선 효과

### Before
- 에러 메시지만 표시
- 사용자가 다음 단계를 알 수 없음

### After
- 제안된 전략 표시
- 모든 거래소 쌍 정보 제공
- 사용자가 상황을 이해하고 결정할 수 있음

---

**작성자**: AI Assistant  
**최종 업데이트**: 2025-11-23

