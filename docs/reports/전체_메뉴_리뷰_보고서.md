# 전체 메뉴 리뷰 보고서

## 검토 일자: 2025-11-30

## 1. 차익거래 비용 계산기 (cost_calculator_page)

### 기능
- 특정 기간, 코인, 거래소 조합에 대한 차익거래 비용 및 수익률 계산
- 백테스트 기반 수익률 분석
- 거래소 쌍별 차익거래 기회 분석

### 사용 데이터
- `binance_spot_daily`, `bybit_spot_daily`, `upbit_daily`, `bitget_spot_daily`
- OHLCV 데이터 (가격, 거래량)

### 데이터 품질 검토
- ✅ BTC: 전체 기간 데이터 존재
- ⚠️ ETH: 일부 거래소 데이터 누락 가능성 (Bitget API V1 폐지)

### 계산 오류 검토
- ✅ 비용 계산 로직 정상
- ✅ 백테스트 엔진 정상 작동

---

## 2. 최적 전략 추천 (strategy_recommender_page)

### 기능
- 거래소 쌍별 최적 전략 추천
- 수익률 기반 랭킹
- 리스크 대비 수익률 분석

### 사용 데이터
- 차익거래 비용 계산기와 동일

### 데이터 품질 검토
- ✅ 차익거래 비용 계산기와 동일한 데이터 소스 사용

### 계산 오류 검토
- ✅ 전략 추천 로직 정상

---

## 3. 리스크 예측 대시보드 (risk_dashboard_page)

### 기능
- 특정 날짜의 리스크 예측 (고변동성 확률, 청산 리스크)
- 동적 지표 시각화
- 파생상품 지표 분석
- 거래소 유입/유출 분석
- 최근 리스크 이력

### 사용 데이터
- `binance_futures_metrics`: OI, Funding Rate, Long/Short Ratio
- `futures_extended_metrics`: Extended Metrics (Taker Ratio, Top Trader Ratio 등)
- `bitinfocharts_whale`: 고래 집중도
- `whale_daily_stats`: 거래소 유입/유출

### 데이터 품질 검토
- ✅ BTC: 전체 기간 데이터 존재 (2022-01-01부터)
- ⚠️ ETH: 최근 30일만 7행 (전체 1430행은 존재하지만 최근 데이터 부족)
- ✅ 고래 집중도: 데이터 존재
- ✅ 거래소 유입/유출: 수정 완료 (BUY/SELL 매핑 수정)

### 계산 오류 검토
- ✅ 청산 리스크 계산: 정규화 적용 완료 (100% 문제 해결)
- ✅ 고래 집중도 차트: 데이터 유효성 확인 추가
- ✅ 동적 변수: features 불일치 문제 수정

---

## 4. 역사적 리스크 분석 (historical_analysis_page)

### 기능
- 과거 데이터 기반 리스크 패턴 분석
- 모델 예측 정확도 확인
- 고변동성 구간 목록
- 지표별 상관관계 분석

### 사용 데이터
- `binance_futures_metrics`
- `bitinfocharts_whale`
- `predict_batch` 결과

### 데이터 품질 검토
- ✅ 변동성 데이터: 상관관계 행렬에 정상 포함
- ✅ 고변동성 구간 분석: 정상 작동

### 계산 오류 검토
- ✅ 상관관계 계산: 정상 작동
- ✅ 성능 지표 계산: 정상 작동

---

## 5. 특성 중요도 분석 (feature_analysis_page)

### 기능
- 특성 중요도 시각화
- SHAP 값 분석
- Partial Dependence Plot
- 특정 예측 상세 분석

### 사용 데이터
- 모델 메타데이터 (`risk_ai_metadata.json`)
- 학습된 모델 파일

### 데이터 품질 검토
- ✅ 특성 중요도: 메타데이터 또는 모델에서 추출
- ✅ SHAP: features 불일치 문제 수정 완료
- ✅ Partial Dependence: features 불일치 문제 수정 완료

### 계산 오류 검토
- ✅ SHAP 계산: 누락된 features를 0으로 채우는 로직 추가
- ✅ Partial Dependence: 누락된 features를 0으로 채우는 로직 추가

---

## 6. 파생상품 지표 분석 (derivatives_analysis_page)

### 기능
- OI (미결제약정) 분석
- 롱/숏 비율 분석
- Taker Buy/Sell Ratio 분석
- 펀딩비 분석 (Binance, Bybit)
- 종합 상관관계 분석

### 사용 데이터
- `binance_futures_metrics`: OI, Funding Rate
- `futures_extended_metrics`: Extended Metrics

### 데이터 품질 검토
- ✅ BTC: 전체 기간 데이터 존재
- ⚠️ ETH: 최근 30일만 7행 (전체 1430행은 존재)
  - 원인: `load_risk_data`가 최근 30일만 조회했을 때 실제 데이터가 7일만 있음
  - 해결: 전체 기간 조회 시 1430행 존재 확인

### 계산 오류 검토
- ✅ OI 변화율 계산: 정상
- ✅ Taker Ratio: NaN 처리 추가
- ✅ 펀딩비 분석: 정상

---

## 7. 동적 변수 분석 (dynamic_variables_page)

### 기능
- 동적 변수 시각화 (변화율, 가속도, 기울기)
- 동적 변수와 가격 상관관계 분석
- 동적 변수 백테스트 결과

### 사용 데이터
- `feature_engineering` 모듈에서 생성된 동적 변수
- 가격 데이터

### 데이터 품질 검토
- ✅ 동적 변수 생성: 정상 작동
- ✅ 상관관계 분석: 정상 작동
- ✅ 백테스트: 정상 작동

### 계산 오류 검토
- ✅ 동적 변수 계산: 정상
- ✅ 상관관계 분석: 정상
- ✅ 백테스트: 정상

---

## 8. 모델 성능 비교 (model_comparison_page)

### 기능
- 모델별 성능 지표 비교 (AUC-ROC, F1 Score 등)
- 모델별 예측 결과 비교
- 특성 중요도 비교

### 사용 데이터
- 모델 평가 결과 파일 (`model_comparison_summary.csv`)
- 모델별 예측 결과

### 데이터 품질 검토
- ✅ 모델 평가 결과: 파일 존재 확인 필요
- ⚠️ 예측 결과: 데이터 없을 때 가장 가까운 날짜 자동 사용 문제 → 수정 완료

### 계산 오류 검토
- ✅ 모델 성능 비교: 정상
- ✅ 예측 결과 비교: 데이터 없으면 없는 것으로 표시 (수정 완료)

---

## 9. 종합 대시보드 (comprehensive_dashboard_page)

### 기능
- 리스크 점수 카드
- 동적 지표
- 파생상품 지표
- 거래소 유입/유출
- 고래 데이터 상관관계
- 최근 리스크 이력

### 사용 데이터
- 모든 리스크 관련 데이터 통합

### 데이터 품질 검토
- ✅ 리스크 예측: 정상
- ⚠️ 최근 리스크 이력: 데이터 없을 때 명확한 메시지 표시 (수정 완료)
- ✅ 동적 지표: 정상
- ✅ 파생상품 지표: 정상
- ✅ 거래소 유입/유출: 정상

### 계산 오류 검토
- ✅ 리스크 점수 계산: 정상
- ✅ 동적 지표: 정상
- ✅ 최근 리스크 이력: 데이터 없으면 없는 것으로 표시 (수정 완료)

---

## 전체 요약

### 수정 완료된 문제
1. ✅ 청산 리스크 100% 문제: `predict_batch`에서 정규화 적용
2. ✅ 고래 집중도 변화 차트: 데이터 유효성 확인 추가
3. ✅ 특성 중요도 분석 (SHAP, Partial Dependence): features 불일치 수정
4. ✅ 모델 성능 비교: 데이터 없으면 없는 것으로 표시
5. ✅ 종합 대시보드: 데이터 없으면 없는 것으로 표시

### 확인된 데이터 현황
- ✅ BTC: 전체 기간 데이터 정상 (2022-01-01부터)
- ✅ ETH: 전체 기간 데이터 존재 (1430행, 2022-01-01부터)
  - 최근 30일만 7행인 것은 실제 데이터가 7일만 있다는 의미
  - 전체 기간 조회 시 정상 작동

### 남은 이슈
- ⚠️ ETH 최근 데이터 부족: 실제 데이터 수집 상태 확인 필요
- ⚠️ Bitget API V1 폐지: ETH 데이터 수집에 영향 가능성

---

## 권장 사항

1. **ETH 데이터 수집 상태 확인**
   - 최근 30일 데이터가 7행만 있는 원인 확인
   - Binance Vision 아카이브에서 최신 데이터 수집 필요 여부 확인

2. **데이터 품질 모니터링**
   - 정기적으로 데이터 수집 상태 확인
   - 누락된 데이터 자동 감지 및 알림

3. **에러 처리 개선**
   - 모든 페이지에서 데이터 없을 때 명확한 메시지 표시
   - 사용자 친화적인 안내 메시지

